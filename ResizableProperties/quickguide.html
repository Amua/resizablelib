<HTML> <HEAD> <TITLE>The Code Project - CResizableSheet and CResizablePage</TITLE> <STYLE>body { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10pt } h2 { color: #0066ff; font-size: 13pt; font-weight: bold } h3 { color: #0066ff; font-size: 12pt; font-weight: bold; font-style: italic } h3 { color: #0066ff; font-size: 11pt; font-weight: bold } pre { background-color: #FBEDBB; font-family: 'Courier New', Courier, mono; white-space: pre } code { color: #990000; font-family: 'Courier New', Courier, mono } </STYLE>   </HEAD> <BODY BGCOLOR="#FFFFFF" COLOR="#000000"> <H1>CResizableSheet and CResizablePage</H1> <P>&nbsp;</P> <H2>Quick Guide</H2> <BLOCKQUOTE> <P>Here is an extract of the article you can find on CodeProject.</P> <P>Please, refer to that article for everything you may need. This could be an old version of the Reference, but should be useful to start.</P> <P>Check for updates on CodeProject: <A HREF="http://www.codeproject.com">www.codeproject.com</A> (Dialogs and Windows programming)</P> </BLOCKQUOTE> <H2><A NAME="reference"></A>Class Reference</H2> <H5>CResizableSheet::CResizableSheet</H5> <PRE>CResizableSheet()
CResizableSheet(UINT nIDTemplate, CWnd* pParentWnd = NULL)
CResizableSheet(LPCTSTR lpszTemplateName, CWnd* pParentWnd = NULL)</PRE> <H5>CResizablePage::CResizablePage</H5> <PRE>CResizablePage()
CResizablePage(UINT nIDTemplate, CWnd* pParentWnd = NULL)
CResizablePAge(LPCTSTR lpszTemplateName, CWnd* pParentWnd = NULL)</PRE> <DL> <DD> <P>The first form is the default constructor.</P> <P>The second and the third forms are needed to reproduce the construction scheme of a <CODE>CPropertySheet/Page</CODE> derived class. Since the dialog resource template is needed by the <CODE>CPropertySheet/Page</CODE> constructor, you have to call one of these forms of the <CODE>CResizableSheet/Page</CODE> constructor. This is the reason why replacing one class with the other will work (see the <A HREF="#usage">Usage</A> section).</P> </DD> </DL> <H5>CResizablePage::AddAnchor</H5> <PRE>void AddAnchor(HWND wnd, CSize tl_type, CSize br_type = NOANCHOR)
void AddAnchor(UINT ctrl_ID, CSize tl_type, CSize br_type = NOANCHOR)</PRE> <DL> <DD> <P>Add a control to the layout list and set the anchor type for the top-left and bottom-right corners of the control. During a resizing operation the control's corners are kept at fixed distance from the dialog point you specify: argument's <CODE>cx</CODE> member is the horizontal position, while <CODE>cy</CODE> is vertical, in percentage.</P> <P>A set of useful constant values, provided also for compatibility, is defined:</P> <DD> <PRE>const CSize
	NOANCHOR(-1,-1),
	TOP_LEFT(0,0), TOP_CENTER(50,0), TOP_RIGHT(100,0),
	MIDDLE_LEFT(0,50), MIDDLE_CENTER(50,50), MIDDLE_RIGHT(100,50),
	BOTTOM_LEFT(0,100), BOTTOM_CENTER(50,100), BOTTOM_RIGHT(100,100);</PRE> <DD> <P>I think their meaning is self-explaining. Using <CODE>NOANCHOR</CODE> for top-left corner is not allowed, so it will generate an 'assertion failed' in the Debug version.</P> <P>Note that there is no need to set a layout for the property sheet itself, because it's done automatically by the <CODE>CResizableSheet::OnInitDialog</CODE> handler.</P> </DD> </DL> <H5>CResizableSheet::GetMinWidth</H5> <PRE>int GetMinWidth()</PRE> <DL> <DD> <P>Calculates the minimum width required to correctly display all active buttons.</P> <P>Can be used to set the minimum tracking size.</P> </DD> </DL> <H5>CResizableSheet::ShowSizeGrip</H5> <PRE>void ShowSizeGrip(BOOL bShow)</PRE> <DL> <DD> <P>Shows or hides the size grip at the bottom-right corner of the dialog, depending on the value of <CODE>bShow</CODE> parameter: <CODE>TRUE</CODE> means visible while <CODE>FALSE</CODE> is hidden. Default is visible.</P> <P>Note that when the dialog is maximized, the size grip is hidden regardless of this setting.</P> </DD> </DL> <H5>CResizableSheet::SetMaximizedRect</H5> <PRE>void SetMaximizedRect(const CRect&amp; rc)</PRE> <DL> <DD> <P>Sets the rectangular area that the dialog will occupy when maximized. Default is the standard size and position set by the system (the available portion of the screen).</P> </DD> </DL> <H5>CResizableSheet::ResetMaximizedRect</H5> <PRE>void ResetMaximizedRect()</PRE> <DL> <DD> <P>Reverts the effect of a previous call to <CODE>SetMaximizedRect</CODE>, that is maximizing the dialog will produce the standard behavior.</P> </DD> </DL> <H5>CResizableSheet::SetMinTrackSize</H5> <PRE>void SetMinTrackSize(const CSize&amp; size)</PRE> <DL> <DD> <P>Sets the minimum size of the dialog when resized. Default is the initial dialog size. This setting does not affect the behavior of a minimize operation, which always produce the expected result.</P> </DD> </DL> <H5>CResizableSheet::ResetMinTrackSize</H5> <PRE>void ResetMinTrackSize()</PRE> <DL> <DD> <P>Reverts the effect of a previous call to <CODE>SetMinTrackSize</CODE>, that is the standard minimum size is set by the system. You may call this in your <CODE>OnInitDialog</CODE> to change the initial default setting.</P> </DD> </DL> <H5>CResizableSheet::SetMaxTrackSize</H5> <PRE>void SetMaxTrackSize(const CSize&amp; size)</PRE> <DL> <DD> <P>Sets the maximum size of the dialog when resized. Default is the standard size set by the system (the available portion of the screen). Note that this setting affects the behavior of a maximize operation and maximized size is clipped to this value by the system.</P> </DD> </DL> <H5>CResizableSheet::ResetMaxTrackSize</H5> <PRE>void ResetMaxTrackSize()</PRE> <DL> <DD> <P>Reverts the effect of a previous call to <CODE>SetMaxTrackSize</CODE>, that is the standard maximum size is set by the system.</P> </DD> </DL> <H5>CResizableSheet::EnableSaveRestore</H5> <PRE>void EnableSaveRestore(LPCTSTR pszSection, LPCTSTR pszEntry, BOOL bWithPage = FALSE)</PRE> <DL> <DD> <P>Enables automatic save/restore on dialog's open/close operations. The first two arguments are the same as in <CODE>CWinApp::WriteProfileString</CODE>. The last is a flag for restoring the active page (active page is always saved). <P>If you want details on how these settings are stored, look at <CODE>CWinApp::SetRegistryKey</CODE>, <CODE>CWinApp::m_pszProfileName</CODE>, <CODE>CWinApp::m_pszRegistryKey</CODE> on MFC documentation.</P> </DD> </DL> <H2>Contact Author</H2> <BLOCKQUOTE> <P>For any question, comment, suggestion, please use the space provided by CodeProject at the end of my article.</P> <P>Paolo Messina (PPEscher)</P> <P>My pages: <A HREF="http://www.geocities.com/ppescher">www.geocities.com/ppescher<BR> </A>My email: <A HREF="mailto:ppescher@yahoo.com">ppescher@yahoo.com</A></P> </BLOCKQUOTE> </BODY> </HTML> 