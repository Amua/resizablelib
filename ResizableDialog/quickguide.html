<HTML> <HEAD> <TITLE>CResizableDialog</TITLE> <STYLE>body { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10pt } h2 { color: #0066ff; font-size: 13pt; font-weight: bold } h3 { color: #0066ff; font-size: 12pt; font-weight: bold; font-style: italic } h3 { color: #0066ff; font-size: 11pt; font-weight: bold } pre { background-color: #FBEDBB; font-family: 'Courier New', Courier, mono; white-space: pre } code { color: #990000; font-family: 'Courier New', Courier, mono } </STYLE>   </HEAD> <H1>CResizableDialog</H1> <P>&nbsp;</P> <H2>Quick Guide</H2> <BLOCKQUOTE> <P>Here is an extract of the article you can find on CodeProject.</P> <P>Please, refer to that article for everything you may need. This could be an old version of the Reference, but should be useful to start.</P> <P>Check for updates on CodeProject: <A HREF="http://www.codeproject.com">www.codeproject.com</A> (Dialogs and Windows programming)</P> </BLOCKQUOTE> <H2><A NAME="usage"></A>Usage - Step by Step</H2> <BLOCKQUOTE> <P>Add the files 'ResizableDialog.cpp' and 'ResizableDialog.h' to your project.</P> <P>Create a dialog resource and associate it with a CDialog derived class, for example using ClassWizard, or take a dialog you have already made which you want to be resizable.</P> <P>Open the dialog properties and change the border style to 'Resizing'. You may also add Minimize/Maximize buttons to the title bar.</P> <P>Include 'ResizableDialog.h' in the associated header file.</P> <P>Search and replace all <CODE>CDialog</CODE> occurences with <CODE>CResizableDialog</CODE> in both your .cpp and .h files, just as if your dialog class was derived from CResizableDialog instead of CDialog. I think there's no way to let the ClassWizard do this for you. Let me know if I'm wrong, please.</P> <P>Your header file should appear like this:</P> <PRE>// DemoDlg.h : header file
//

// ( ClassWizard stuff )

/////////////////////////////////////////////////////////////////////////////
// CDemoDlg dialog

<FONT COLOR="#FF0000">#include &quot;ResizableDialog.h&quot;
</FONT>
class CMyDialog : public <FONT COLOR="#FF0000">CResizableDialog</FONT>
{
// Construction
public:
	CDemoDlg(CWnd* pParent = NULL);	// standard constructor

// ( other stuff )
// ...
}
</PRE> <P>In your <CODE>OnInitDialog</CODE> override, add an anchor for each control you want the size and/or position to be changed when the user resizes the dialog.</P> <PRE>BOOL CMyDialog::OnInitDialog()
{
	<FONT COLOR="#FF0000">CResizableDialog</FONT>::OnInitDialog();

	// Set the icon for this dialog. The framework does this
	// automatically when the application's main window is not a dialog
	SetIcon(m_hIcon, TRUE);	// Set big icon
	SetIcon(m_hIcon, FALSE);	// Set small icon

	// preset layout
	<FONT COLOR="#FF0000">AddAnchor(IDOK, BOTTOM_RIGHT);
	AddAnchor(IDCANCEL, BOTTOM_RIGHT);
	
	AddAnchor(IDC_SPIN1, TOP_RIGHT);

	AddAnchor(IDC_LABEL1, TOP_LEFT);
	AddAnchor(IDC_EDIT1, TOP_LEFT, BOTTOM_RIGHT);

	AddAnchor(IDC_RADIO1, BOTTOM_LEFT);
	AddAnchor(IDC_RADIO2, BOTTOM_LEFT);
	AddAnchor(IDC_GROUP1, BOTTOM_LEFT, BOTTOM_RIGHT);</FONT>
	
	// other initializations
	// ...
</PRE> <P>Here you may also set a maximum size for your dialog (default is the screen size), a minimum size (default is the one you see in the resource editor) and also a rectangle that the dialog occupies when maximized.</P> <PRE>	// get desktop size
	CRect rc;
	GetDesktopWindow()-&gt;GetClientRect(&amp;rc);

	// set max tracking size to half a screen
	<FONT COLOR="#FF0000">SetMaxTrackSize(CSize(rc.Width(), rc.Height()/2));</FONT>

	// maximized position and size on top of the screen
	rc.bottom = 100;
	<FONT COLOR="#FF0000">SetMaximizedRect(rc);</FONT>
</PRE> <P>After all this settings, you may wish the dialog's size and position to be automatically saved and restored, as well as its maximized or minimized state. Just provide a Section and an Entry name in your application's profile, in which to save dialog's status.</P> <PRE>	// save/restore
	// (for dialog based app, default is a .INI file with
	// the application's name in the Windows directory)
	<FONT COLOR="#ff0000">EnableSaveRestore(_T(&quot;DemoDlg&quot;), _T(&quot;Window&quot;));</FONT>
</PRE> <P>You are ready to rebuild your project and you will have a resizable dialog just as you wanted.</P> <P>For further details, see the <A HREF="#reference">Reference</A> section below.</P> </BLOCKQUOTE> <H2><A NAME="reference"></A>Class Reference</H2> <BLOCKQUOTE> <H5>CResizableDialog::CResizableDialog</H5> <PRE>CResizableDialog()
CResizableDialog(UINT nIDTemplate, CWnd* pParentWnd = NULL)</PRE> <DL> <DD> <P>The first is the default constructor.</P> <P>The second form is needed to reproduce the construction scheme of a <CODE>CDialog</CODE> derived class. Since the dialog resource template ID is needed by the <CODE>CDialog</CODE> constructor, you have to call this form of the <CODE>CResizableDialog</CODE> constructor. This is the reason why replacing one class with the other will work (see the <A HREF="#usage">Usage</A> section).</P> </DD> </DL> <H5>CResizableDialog::AddAnchor</H5> <PRE>void AddAnchor(HWND wnd, CSize tl_type, CSize br_type = NOANCHOR)
void AddAnchor(UINT ctrl_ID, CSize tl_type, CSize br_type = NOANCHOR)</PRE> <DL> <DD> <P>Add a dialog control to the layout list and set the anchor type for the top-left and bottom-right corners of the control. During a resizing operation the control's corners are kept at fixed distance from the dialog point you specify: argument's <CODE>cx</CODE> member is the horizontal position, while <CODE>cy</CODE> is vertical, in percentage.</P> <P>A set of useful constant values, provided also for compatibility, is defined:</P> <DD> <PRE>const CSize
	NOANCHOR(-1,-1),
	TOP_LEFT(0,0), TOP_CENTER(50,0), TOP_RIGHT(100,0),
	MIDDLE_LEFT(0,50), MIDDLE_CENTER(50,50), MIDDLE_RIGHT(100,50),
	BOTTOM_LEFT(0,100), BOTTOM_CENTER(50,100), BOTTOM_RIGHT(100,100);</PRE> <DD>I think their meaning is self-explained. Using <CODE>NOANCHOR</CODE> for top-left corner is not allowed, so it will generate an 'assertion failed' in the Debug version.</DD> </DL> <H5>CResizableDialog::ShowSizeGrip</H5> <PRE>void ShowSizeGrip(BOOL bShow)</PRE> <DL> <DD> <P>Shows or hides the size grip at the bottom-right corner of the dialog, depending on the value of <CODE>bShow</CODE> parameter: <CODE>TRUE</CODE> means visible while <CODE>FALSE</CODE> is hidden. Default is visible.</P> <P>Note that when the dialog is maximized, the size grip is hidden regardless of this setting.</P> </DD> </DL> <H5>CResizableDialog::SetMaximizedRect</H5> <PRE>void SetMaximizedRect(const CRect&amp; rc)</PRE> <DL> <DD>Sets the rectangular area that the dialog will occupy when maximized. Default is the standard size and position set by the system (the available portion of the screen).</DD> </DL> <H5>CResizableDialog::ResetMaximizedRect</H5> <PRE>void ResetMaximizedRect()</PRE> <DL> <DD>Reverts the effect of a previous call to <CODE>SetMaximizedRect</CODE>, that is maximizing the dialog will produce the standard behavior.</DD> </DL> <H5>CResizableDialog::SetMinTrackSize</H5> <PRE>void SetMinTrackSize(const CSize&amp; size)</PRE> <DL> <DD>Sets the minimum size of the dialog when resized. Default is the template's size. This setting does not affect the behavior of a minimize operation, which always produce the expected result.</DD> </DL> <H5>CResizableDialog::ResetMinTrackSize</H5> <PRE>void ResetMinTrackSize()</PRE> <DL> <DD>Reverts the effect of a previous call to <CODE>SetMinTrackSize</CODE>, that is the standard minimum size set by the system. You may call this in your <CODE>OnInitDialog</CODE> to change the initial default setting.</DD> </DL> <H5>CResizableDialog::SetMaxTrackSize</H5> <PRE>void SetMaxTrackSize(const CSize&amp; size)</PRE> <DL> <DD>Sets the maximum size of the dialog when resized. Default is the standard size set by the system (the available portion of the screen). Note that this setting affects the behavior of a maximize operation and maximized size is clipped to this value by the system.</DD> </DL> <H5>CResizableDialog::ResetMaxTrackSize</H5> <PRE>void ResetMaxTrackSize()</PRE> <DL> <DD>Reverts the effect of a previous call to <CODE>SetMaxTrackSize</CODE>, that is the standard maximum size set by the system.</DD> </DL> <H5>CResizableDialog::EnableSaveRestore</H5> <PRE>void EnableSaveRestore(LPCTSTR pszSection, LPCTSTR pszEntry)</PRE> <DL> <DD> <P>Enables automatic save/restore on dialog's open/close operations. The arguments are the same as in <CODE>CWinApp::WriteProfileString</CODE>. <P>If you want details on how this setting are stored, look at <CODE>CWinApp::SetRegistryKey</CODE>, <CODE>CWinApp::m_pszProfileName</CODE>, <CODE>CWinApp::m_pszRegistryKey</CODE> on MFC documentation.</P> </DD> </DL> </BLOCKQUOTE> <H2>Contact Author</H2> <BLOCKQUOTE> <P>For any question, comment, suggestion, please use the space provided by CodeProject at the end of my article.</P> <P>Paolo Messina (PPEscher)</P> <P>My pages: <A HREF="http://www.geocities.com/ppescher">www.geocities.com/ppescher<BR> </A>My email: <A HREF="mailto:ppescher@yahoo.com">ppescher@yahoo.com</A></P> </BLOCKQUOTE> 